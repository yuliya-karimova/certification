
# Автоматическая система проверки требований и сертификации

## Описание проекта

Проект представляет собой агентную систему для автоматической проверки бизнес-требований (use case) на соответствие международным регламентам сертификации, особенно в автомобильной промышленности. Система создана для автоматизации трудоемкого процесса анализа технических требований, применимых к объектам, которые должны соответствовать регламентам сертификации, таким как Регламенты ООН (ECE). 

Основная задача проекта — упростить проверку и улучшить качество бизнес-требований за счет автоматического анализа текста use case и сопоставления с актуальными регламентами сертификации.

### Ключевые возможности:
- Автоматический анализ структуры и логики сценариев использования (use case).
- Идентификация объектов, подлежащих сертификации.
- Подбор и проверка регламентов для каждого объекта.
- Генерация детализированных отчетов в формате DOCX, PDF и Excel.

## Архитектура системы

Система состоит из трех модулей (агентов), которые выполняют следующие ключевые функции:

1. **Агент анализа структуры use case**: 
   - Проверяет корректность структуры бизнес-требований (use case) на основе лучших практик (например, Alistair Cockburn).
   - Анализирует правильность наименований, контекста, списка акторов, сценариев и альтернативных путей выполнения use case.
   - Формирует рекомендации по улучшению описания требований для достижения максимального соответствия стандартам.

2. **Агент идентификации сертифицируемых объектов**:
   - Идентифицирует в тексте объекты, подлежащие сертификации (например, системы рулевого управления, тормоза, ремни безопасности и другие компоненты).
   - Сопоставляет каждый найденный объект с регламентами ООН, такими как Регламент №79 для рулевых механизмов или Регламент №13 для тормозных систем.
   - Исключает объекты, которые не подлежат сертификации, чтобы избежать излишней проверки.

3. **Агент детализированной проверки регламентов**:
   - Проверяет соответствие каждого сертифицируемого объекта всем применимым пунктам регламентов.
   - Проводит детальный анализ каждого объекта, сопоставляя его с требованиями безопасности, надежности и методами тестирования, изложенными в регламентах.
   - Формирует отчет, в котором указываются все соответствующие и несоответствующие пункты регламентов, а также рекомендации по устранению выявленных проблем.

## Принципы работы

Система следует нескольким важным принципам для достижения высокой точности и эффективности проверки:

1. **Модульная структура**: Каждый агент отвечает за свою специфическую часть проверки, что позволяет системе быть гибкой и масштабируемой.
2. **Интеграция с OpenAI**: Для анализа текста и генерации рекомендаций система использует API OpenAI, что позволяет выполнять сложный анализ текста на естественном языке.
3. **Гибкость проверки**: Система может работать с широким спектром бизнес-требований и регламентов, поддерживая разные уровни зрелости use case (от базовых до сложных).
4. **Автоматическая генерация отчетов**: Результаты проверки выводятся в удобном формате (DOCX, PDF, Excel), что упрощает передачу данных и интерпретацию результатов.


## Киллер-фичи

### 1. Подготовка регламентов в формате JSON
Одна из ключевых особенностей системы заключается в подготовке и хранении регламентов в формате JSON. Это позволяет:
- Улучшить процесс поиска нужных разделов и таблиц с помощью языковой модели (GPT).
- Упрощает структурированный доступ к регламентам, ускоряя их обработку.
- Позволяет быстро находить ключевые элементы регламентов для проверки их на соответствие требованиям.

### 2. Настройка тщательности анализа через управление chunk_size
Система предоставляет возможность регулировать глубину и тщательность анализа регламентов через настройку параметра `chunk_size`, который отвечает за разбиение данных на части (чанки). Это позволяет:
- **Меньший размер chunk_size** (например, 50 000 символов): анализировать данные более детально, повышая точность обработки.
- **Больший размер chunk_size** (например, 100 000 символов): ускорять процесс анализа за счёт меньшего количества запросов, однако возможно снижение точности при работе с большими объёмами данных.
- Баланс между тщательностью анализа и скоростью выполнения настраивается в зависимости от требований проекта.

### 3. Выделение сертифицируемых объектов и анализ соответствия регламентам
Система автоматически анализирует документы, выделяя сертифицируемые объекты (например, рулевые механизмы, тормозные системы, ремни безопасности). Особенности:
- Автоматически выполняется анализ всех сущностей, упомянутых в документации (use case), и их проверка на соответствие регламентам.
- Каждая сущность дополнительно анализируется на соответствие конкретным пунктам регламента.
- После анализа по каждому пункту система формирует сводный отчет, содержащий подробные результаты по каждому сертифицируемому объекту.

## Алгоритм работы

Алгоритм работы системы включает несколько этапов:

1. **Анализ структуры use case**:
   - Система проверяет наличие обязательных элементов, таких как цель, актеры, сценарии, предусловия и постусловия.
   - Если структура неполная или некорректная, агент генерирует рекомендации для ее улучшения.
   - На основе лучших практик (например, Alistair Cockburn) система анализирует логику сценария и дает рекомендации по корректировке текста.

2. **Идентификация сертифицируемых объектов**:
   - Система автоматически ищет объекты, которые могут подлежать сертификации, такие как тормозные системы, ремни безопасности, стеклоочистители и т.д.
   - Каждому объекту сопоставляется один или несколько регламентов ООН (например, Регламент №16 для ремней безопасности).

3. **Проверка на соответствие регламентам**:
   - Агент анализирует каждый объект на соответствие требованиям регламентов ООН. Например, система проверяет, соответствуют ли описанные в use case тормозные системы требованиям Регламента №13.
   - Для каждого объекта генерируется список соответствующих и несоответствующих пунктов регламента.
   - Если есть несоответствия, агент дает конкретные рекомендации для их исправления.

4. **Генерация отчета**:
   - После завершения всех этапов проверки система формирует итоговый отчет, который включает в себя:
     - Статус проверки каждого объекта (соответствует/не соответствует).
     - Количество соблюденных и несоблюденных регламентов.
     - Рекомендации по улучшению.
   - Отчет генерируется в нескольких форматах (DOCX, PDF, Excel) для удобного анализа и передачи данных.

## Описание файлов

- **ai.py** — Основной модуль системы, который отвечает за взаимодействие с OpenAI API для выполнения анализа текста, генерации рекомендаций и проверки объектов на соответствие регламентам.
  - Содержит функции для анализа use case, проверки регламентов и работы с объектами сертификации.
  - Использует библиотеку FastAPI для создания API и взаимодействия с другими модулями.

- **app.py** — Веб-приложение на базе Flask, предоставляющее REST API для загрузки файлов и взаимодействия с системой.
  - Реализованы эндпоинты для проверки use case, проверки сертификации объектов и генерации отчетов.
  - Включает поддержку загрузки файлов (DOCX, PDF) и их последующей обработки.

- **utils.py** — Вспомогательный модуль, включающий функции для работы с документами (извлечение текста из DOCX и PDF), генерации отчетов в формате DOCX, PDF и Excel.
  - Содержит функции для обработки текстовых данных и сохранения промежуточных результатов в файлы.

## Как запустить

Запустите приложение с помощью команды:

```bash
python app.py
```

Приложение будет доступно по адресу: `http://localhost:8000`.


## Пример работы

### Пример анализа use case:

1. Система получает описание use case:
   ```text
   Title: "Activate braking system"
   Goal: "The system should activate the brakes when..."
   ```

2. Первый агент анализирует текст и обнаруживает, что не все обязательные элементы присутствуют. Формируется рекомендация:
   - Добавить описание предусловий и постусловий для завершенности use case.
   - Изменить название для соответствия стандарту: "<Verb> <Noun>".

3. Второй агент идентифицирует сертифицируемый объект — тормозную систему (подпадает под Регламент №13).

4. Третий агент проверяет соответствие use case требованиям Регламента №13 и выявляет, что нужно описать минимальное время отклика системы в соответствии с регламентом.

5. Генерируется отчет с указанием всех несоответствий и рекомендаций для их исправления.


